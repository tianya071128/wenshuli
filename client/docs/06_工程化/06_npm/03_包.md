---
title: 包(packages)
date: 2021-10-21 15:00:00
permalink: /npm/createPackage
categories: -- 工程化
  -- npm
tags:
  - null
---

# 包(packages)

## 包和模块

npm 注册表包含包，其中许多也是 Node 模块，或者包含 Node 模块。

### 关于模块

模块是 `node_modules` 目录中可以由 Node.js 的 `require()` 函数加载的任何文件或目录。模块必须是以下之一：

* 包含 `package.json` 文件的文件夹，其中包含`“main”`字段。
* 一个 JavaScript 文件。

::: warning 注意

由于模块不需要有 `package.json` 文件，因此并非所有模块都是包。只有具有 `package.json` 文件的模块也是包。

:::

### 关于包

包是由 `package.json` 文件描述的文件或目录。**包必须包含 `package.json` 文件才能发布到 npm 注册表**。

包是以下任何一种：

* a) 包含由 package.json 文件描述的程序的文件夹。
* b) 包含 (a) 的压缩包
* c) 解析为 (b) 的 URL。
* d) 使用 (c) 在注册表上发布的 `<name>@<version>`。
* e) 指向 (d) 的 `<name>@<tag>`。
* g) 一个 `git url`，在克隆时会导致 (a)。

### 关于范围包(作用域包)

当注册了 npm 账户或创建组织时，将获得用户名或组织名称匹配的范围，可以将此范围用作相关**包的命名空间**。

#### 范围包的作用

* 范围允许创建与其他用户或组织创建的包同名的包，而不会发生冲突。
* 范围可以将包分为多个不同功能的包进行管理

#### 范围包的表示

范围名称是 @ 和斜杠之间的所有内容(范围名称是用户名或组织名称)，包名称是斜杠后面的名称：

```
@用户名/包名

@组织名/包名
```

常见的范围包例如：`@babel/`、`@vue/` 等

### 包的可见性

npm 包的可见性取决于包所在的范围（命名空间），以及为包设置的访问级别（私有或公共）：

| 范围   | 访问权限        | 查看和下载                             | 写(publish)                          |
| ------ | --------------- | -------------------------------------- | ------------------------------------ |
| 组织   | 私人的(Private) | 组织中对包具有读取权限的团队成员       | 组织中对包具有读写权限的团队成员     |
| 组织   | 公共的(Public)  | 每个人                                 | 组织中对包具有读写权限的团队成员     |
| 用户   | 私人的(Private) | 包所有者和已被授予对包的读取权限的用户 | 包所有者和被授予对包的读写权限的用户 |
| 用户   | 公共的(Public)  | 每个人                                 | 包所有者和被授予对包的读写权限的用户 |
| 无范围 | 公共的(Public)  | 每个人                                 | 包所有者和被授予对包的读写权限的用户 |

::: warning 注意

* 只有用户帐户可以创建和管理无范围的包。组织只能管理范围包。
* 要创建组织范围的包，您必须首先创建一个组织。

:::

## 创建包

以下示例以无范围的公共包为例，其他包类型可[参考](https://docs.npmjs.com/packages-and-modules/contributing-packages-to-the-registry)

### 创建 package.json 文件

发布到 npm 注册表的包必须包含 package.json 文件，所以需要将 package.json 文件添加到您的包中，以方便其他人管理和安装。

[package.json 文件详解参考](/npm/packageFile/)，但一个包的 `package.json` 文件必须包含 `name` 和 `version` 字段：

* `name`：包含您的包的名称，必须是小写字母和一个单词，并且可以包含连字符和下划线。
* `version`：必须采用 x.x.x 格式并遵循[语义版本控制指南](https://docs.npmjs.com/about-semantic-versioning/)。

```json
{
  "name": "my-awesome-package",
  "version": "1.0.0"
}
```

#### 使用 CLI 创建文件

使用如下步骤创建 `package.json` 文件：

1. 在终端中导航到包的根目录

2. 运行如下命令：

   ```bash
   npm init
   ```

3. 回答命令行问卷中的问题。

![image-20220627170439977](/img/148.png)

#### 使用 CLI 创建默认的 package.json 文件

可以使用从当前目录中提取的信息创建默认的 `package.json` 文件，使用带有  `--yes` 或 `-y` 标志的 `npm init` 命令。

```bash
npm init --yes
```

会从当前目录中提取的默认值：

* `name`: 当前目录名
* `version`: 始终为 `1.0.0`
* `description`: `README` 文件中的信息，或空字符串 `""`
* `scripts`: 默认创建一个空的 `test` 脚本
* `keywords`: 空
* `author`: v
* `license`: [`ISC`](https://opensource.org/licenses/ISC)
* `bugs`: 来自当前目录的信息，如果存在的话
* `homepage`: 来自当前目录的信息，如果存在的话

#### 为 init 命令设置配置选项

可以为 init 命令设置默认配置选项。例如，要设置默认作者电子邮件、作者姓名和许可证，可运行以下命令：

```bash
> npm set init.author.email "example-user@example.com"
> npm set init.author.name "example_user"
> npm set init.license "MIT"
```

**注意：**这个命令是 `npm config set key=value [key=value...]` 的简写





















